{
  "version": 3,
  "sources": ["../../../src/components/controls/text-field.tsx"],
  "sourcesContent": ["import { type Component, type JSX, Show, createSignal, splitProps } from \"solid-js\";\nimport { createFieldState } from \"../../hooks/createFieldState\";\nimport {\n  type TextFieldStyles,\n  textField,\n  textFieldContainer,\n  textFieldContent,\n  textFieldInput,\n} from \"./text-field.css\";\nimport { objPick } from \"@simplysm/core-common\";\nimport \"@simplysm/core-common\";\n\n/**\n * format \uD50C\uB808\uC774\uC2A4\uD640\uB354 \uBB38\uC790 \uB9E4\uCE6D\n * 0: \uC22B\uC790\uB9CC (0-9)\n * X: \uC601\uBB38 \uB300\uBB38\uC790 + \uC22B\uC790 (A-Z, 0-9)\n * x: \uC601\uBB38 \uC18C\uBB38\uC790 + \uC22B\uC790 (a-z, 0-9)\n * *: \uBAA8\uB4E0 \uBB38\uC790\n */\nconst FORMAT_PLACEHOLDERS = /[0Xx*]/;\n\n/**\n * \uD50C\uB808\uC774\uC2A4\uD640\uB354 \uD0C0\uC785\uBCC4 \uC720\uD6A8 \uBB38\uC790 \uD328\uD134\n */\nconst PLACEHOLDER_PATTERNS: Record<string, RegExp> = {\n  \"0\": /[0-9]/,\n  X: /[A-Z0-9]/,\n  x: /[a-z0-9]/,\n  \"*\": /./,\n};\n\n/**\n * raw \uAC12\uC5D0 format \uD328\uD134\uC744 \uC801\uC6A9\n */\nfunction applyFormat(raw: string, format: string): string {\n  let result = \"\";\n  let rawIndex = 0;\n\n  for (const char of format) {\n    if (rawIndex >= raw.length) break;\n\n    if (FORMAT_PLACEHOLDERS.test(char)) {\n      result += raw[rawIndex++];\n    } else {\n      result += char;\n    }\n  }\n\n  return result;\n}\n\n/**\n * \uC785\uB825\uAC12\uC5D0\uC11C format\uC5D0 \uB9DE\uC9C0 \uC54A\uB294 \uBB38\uC790\uB97C \uD544\uD130\uB9C1\uD558\uACE0 raw \uAC12 \uCD94\uCD9C\n */\nfunction extractRaw(input: string, format: string): string {\n  let result = \"\";\n  let formatIndex = 0;\n\n  for (const inputChar of input) {\n    // \uD604\uC7AC \uD3EC\uB9F7 \uC704\uCE58\uC5D0\uC11C \uD50C\uB808\uC774\uC2A4\uD640\uB354\uAC00 \uC544\uB2CC \uBB38\uC790\uB294 \uAC74\uB108\uB700\n    while (formatIndex < format.length && !FORMAT_PLACEHOLDERS.test(format[formatIndex])) {\n      formatIndex++;\n    }\n\n    if (formatIndex >= format.length) break;\n\n    const placeholder = format[formatIndex];\n    const pattern = PLACEHOLDER_PATTERNS[placeholder];\n\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (pattern != null && pattern.test(inputChar)) {\n      result += inputChar;\n      formatIndex++;\n    }\n  }\n\n  return result;\n}\n\n/**\n * format\uC774 \uC22B\uC790 \uC804\uC6A9\uC778\uC9C0 \uD655\uC778\n */\nfunction isNumericFormat(format: string): boolean {\n  for (const char of format) {\n    if (FORMAT_PLACEHOLDERS.test(char) && char !== \"0\") {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * TextField \uCEF4\uD3EC\uB10C\uD2B8\uC758 props\n * @property value - \uD604\uC7AC \uAC12 (onChange\uC640 \uD568\uAED8 \uC0AC\uC6A9 \uC2DC controlled, \uB2E8\uB3C5 \uC0AC\uC6A9 \uC2DC \uCD08\uAE30\uAC12)\n * @property onChange - \uAC12 \uBCC0\uACBD \uC2DC \uD638\uCD9C\uB418\uB294 \uCF5C\uBC31 (\uC788\uC73C\uBA74 controlled \uBAA8\uB4DC)\n * @property type - \uC785\uB825 \uD0C0\uC785 (text, password, email)\n * @property format - \uD3EC\uB9F7 \uD328\uD134 (\uC608: \"000-0000-0000\")\n * @property size - \uD544\uB4DC \uD06C\uAE30 (sm, lg)\n * @property inset - true\uC77C \uACBD\uC6B0 \uD14C\uC774\uBE14 \uC140 \uB4F1\uC5D0\uC11C \uC0AC\uC6A9\uD558\uAE30 \uC704\uD55C \uC778\uC14B \uC2A4\uD0C0\uC77C \uC801\uC6A9\n * @property inline - true\uC77C \uACBD\uC6B0 inline-block\uC73C\uB85C \uD45C\uC2DC\n */\nexport interface TextFieldProps\n  extends Omit<JSX.InputHTMLAttributes<HTMLInputElement>, \"value\" | \"onChange\" | \"type\" | \"size\">,\n    TextFieldStyles {\n  value?: string | undefined;\n  onChange?: (value: string | undefined) => void;\n  type?: \"text\" | \"password\" | \"email\";\n  format?: string;\n}\n\n/**\n * \uD14D\uC2A4\uD2B8 \uC785\uB825 \uD544\uB4DC \uCEF4\uD3EC\uB10C\uD2B8\n *\n * @example\n * ```tsx\n * const [text, setText] = createSignal<string | undefined>(\"hello\");\n * <TextField value={text()} onChange={setText} />\n * <TextField value={text()} onChange={setText} type=\"password\" />\n * <TextField value={text()} onChange={setText} format=\"000-0000-0000\" />\n * ```\n */\nexport const TextField: Component<TextFieldProps> = (props) => {\n  const [local, rest] = splitProps(props, [\n    ...textField.variants(),\n    \"class\",\n    \"value\",\n    \"onChange\",\n    \"type\",\n    \"format\",\n    \"placeholder\",\n  ]);\n\n  const [isFocused, setIsFocused] = createSignal(false);\n\n  const fieldState = createFieldState({\n    value: () => local.value,\n    onChange: () => local.onChange,\n  });\n\n  // \uD45C\uC2DC\uD560 \uAC12 \uACC4\uC0B0\n  const displayValue = () => {\n    const value = fieldState.currentValue() ?? \"\";\n    if (local.format === undefined || local.format === \"\" || isFocused()) {\n      return value;\n    }\n    return applyFormat(value, local.format);\n  };\n\n  // inputMode \uACB0\uC815\n  const inputMode = (): JSX.HTMLAttributes<HTMLInputElement>[\"inputMode\"] => {\n    if (local.type === \"email\") return \"email\";\n    if (local.format !== undefined && local.format !== \"\" && isNumericFormat(local.format)) {\n      return \"numeric\";\n    }\n    return undefined;\n  };\n\n  // \uC785\uB825 \uD578\uB4E4\uB7EC\n  const handleInput: JSX.EventHandler<HTMLInputElement, InputEvent> = (e) => {\n    const input = e.currentTarget;\n    let newValue: string | undefined = input.value;\n\n    if (local.format !== undefined && local.format !== \"\") {\n      // format\uC774 \uC788\uC73C\uBA74 raw \uAC12\uB9CC \uCD94\uCD9C\n      newValue = extractRaw(newValue, local.format);\n    }\n\n    if (newValue === \"\") {\n      newValue = undefined;\n    }\n\n    fieldState.setValue(newValue);\n  };\n\n  // \uD3EC\uCEE4\uC2A4 \uD578\uB4E4\uB7EC\n  const handleFocus: JSX.EventHandler<HTMLInputElement, FocusEvent> = (e) => {\n    setIsFocused(true);\n    if (typeof rest.onFocus === \"function\") {\n      (rest.onFocus as (e: FocusEvent) => void)(e);\n    }\n  };\n\n  // \uBE14\uB7EC \uD578\uB4E4\uB7EC\n  const handleBlur: JSX.EventHandler<HTMLInputElement, FocusEvent> = (e) => {\n    setIsFocused(false);\n    if (typeof rest.onBlur === \"function\") {\n      (rest.onBlur as (e: FocusEvent) => void)(e);\n    }\n  };\n\n  // \uACF5\uD1B5 input props\n  const inputProps = () => ({\n    type: local.type ?? \"text\",\n    value: displayValue(),\n    onInput: handleInput,\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    placeholder: local.placeholder,\n    inputMode: inputMode(),\n    \"aria-disabled\": rest.disabled ? (\"true\" as const) : undefined,\n    \"aria-readonly\": rest.readOnly ? (\"true\" as const) : undefined,\n  });\n\n  return (\n    <Show\n      when={local.inline}\n      fallback={\n        <input\n          {...rest}\n          {...inputProps()}\n          class={[textField(objPick(local, textField.variants())), local.class]\n            .filterExists()\n            .join(\" \")}\n        />\n      }\n    >\n      <div class={textFieldContainer}>\n        <div class={textFieldContent}>\n          {displayValue() !== \"\" ? displayValue() : (local.placeholder ?? \"\\u00A0\")}\n        </div>\n        <input\n          {...rest}\n          {...inputProps()}\n          class={[textFieldInput, textField(objPick(local, textField.variants())), local.class]\n            .filterExists()\n            .join(\" \")}\n        />\n      </div>\n    </Show>\n  );\n};\n"],
  "mappings": "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",
  "names": []
}
