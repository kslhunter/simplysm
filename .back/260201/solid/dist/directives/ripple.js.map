{
  "version": 3,
  "sources": ["../../src/directives/ripple.ts"],
  "sourcesContent": ["import { createEventListener } from \"@solid-primitives/event-listener\";\nimport { onCleanup } from \"solid-js\";\nimport { rippleOut, rippleStyle } from \"./ripple.css\";\n\n/**\n * \uC694\uC18C\uAC00 offset \uAE30\uC900 \uC694\uC18C\uC778\uC9C0 \uD655\uC778 (position: relative/absolute/fixed/sticky)\n */\nfunction isOffsetElement(el: Element): boolean {\n  return [\"relative\", \"absolute\", \"fixed\", \"sticky\"].includes(getComputedStyle(el).position);\n}\n\n/**\n * ripple \uB514\uB809\uD2F0\uBE0C \uC635\uC158\n */\nexport interface RippleOptions {\n  /**\n   * ripple \uD6A8\uACFC \uD65C\uC131\uD654 \uC5EC\uBD80 (\uAE30\uBCF8\uAC12: true)\n   */\n  enabled?: boolean;\n  /**\n   * \uC774\uBCA4\uD2B8 \uC804\uD30C\uB97C \uC911\uB2E8\uD560\uC9C0 \uC5EC\uBD80 (\uAE30\uBCF8\uAC12: false)\n   * true\uB85C \uC124\uC815\uD558\uBA74 \uBD80\uBAA8 \uC694\uC18C\uC758 ripple \uD6A8\uACFC\uB97C \uBC29\uC9C0\uD560 \uC218 \uC788\uB2E4\n   */\n  stopPropagation?: boolean;\n}\n\ndeclare module \"solid-js\" {\n  namespace JSX {\n    interface Directives {\n      ripple: boolean | RippleOptions;\n    }\n  }\n}\n\n/**\n * Material Design \uC2A4\uD0C0\uC77C\uC758 ripple \uD6A8\uACFC\uB97C \uC801\uC6A9\uD558\uB294 \uB514\uB809\uD2F0\uBE0C\n *\n * \uD074\uB9AD \uC2DC \uD074\uB9AD \uC704\uCE58\uC5D0\uC11C \uC6D0\uD615\uC73C\uB85C \uD37C\uC9C0\uB294 \uC2DC\uAC01\uC801 \uD53C\uB4DC\uBC31\uC744 \uC81C\uACF5\uD55C\uB2E4.\n * \uC694\uC18C\uC758 position\uC774 static\uC778 \uACBD\uC6B0 relative\uB85C \uBCC0\uACBD\uD558\uACE0, overflow\uB97C hidden\uC73C\uB85C \uC124\uC815\uD55C\uB2E4.\n *\n * @param el - ripple \uD6A8\uACFC\uB97C \uC801\uC6A9\uD560 HTML \uC694\uC18C\n * @param value - ripple \uD65C\uC131\uD654 \uC5EC\uBD80\uB97C \uBC18\uD658\uD558\uB294 accessor \uB610\uB294 \uC635\uC158 \uAC1D\uCCB4\n *\n * @example\n * ```tsx\n * // \uAE30\uBCF8 \uC0AC\uC6A9\n * <button use:ripple>\uD074\uB9AD</button>\n *\n * // \uC870\uAC74\uBD80 \uD65C\uC131\uD654\n * <button use:ripple={!disabled()}>\uD074\uB9AD</button>\n *\n * // \uC635\uC158 \uC0AC\uC6A9 (\uBD80\uBAA8 ripple \uBC29\uC9C0)\n * <button use:ripple={{ enabled: true, stopPropagation: true }}>\uD074\uB9AD</button>\n * ```\n */\nexport const ripple = (el: HTMLElement, value?: () => boolean | RippleOptions) => {\n  // \uC9C4\uD589 \uC911\uC778 ripple \uD6A8\uACFC\uC758 AbortController\uB4E4\uC744 \uCD94\uC801\n  const activeControllers = new Set<AbortController>();\n\n  // \uCEF4\uD3EC\uB10C\uD2B8 \uC5B8\uB9C8\uC6B4\uD2B8 \uC2DC \uBAA8\uB4E0 \uD65C\uC131 ripple \uC815\uB9AC\n  onCleanup(() => {\n    for (const ac of activeControllers) {\n      ac.abort();\n    }\n    activeControllers.clear();\n    // \uBAA8\uB4E0 \uD65C\uC131 ripple \uC694\uC18C\uB3C4 \uD568\uAED8 \uC81C\uAC70\n    el.querySelectorAll(`.${rippleStyle}`).forEach((rippleEl) => rippleEl.remove());\n  });\n\n  createEventListener(el, \"pointerdown\", (e: PointerEvent) => {\n    const options = value?.();\n\n    // boolean \uB610\uB294 RippleOptions \uCC98\uB9AC\n    const enabled = options === undefined || options === true || (typeof options === \"object\" && options.enabled !== false);\n    const shouldStopPropagation = typeof options === \"object\" && options.stopPropagation === true;\n\n    if (!enabled) return;\n\n    // stopPropagation \uC635\uC158\uC774 true\uC77C \uB54C\uB9CC \uC774\uBCA4\uD2B8 \uC804\uD30C \uC911\uB2E8\n    if (shouldStopPropagation) {\n      e.stopPropagation();\n    }\n    // \uC704\uCE58 \uBC0F overflow \uC124\uC815\n    if (!isOffsetElement(el)) {\n      el.style.position = \"relative\";\n    }\n    el.style.overflow = \"hidden\";\n\n    // ripple \uD06C\uAE30 \uBC0F \uC704\uCE58 \uACC4\uC0B0\n    const rect = el.getBoundingClientRect();\n    const clickX = e.clientX - rect.left;\n    const clickY = e.clientY - rect.top;\n\n    // \uD074\uB9AD \uC704\uCE58\uC5D0\uC11C 4\uAC1C \uBAA8\uC11C\uB9AC\uAE4C\uC9C0\uC758 \uAC70\uB9AC \uC911 \uCD5C\uB300\uAC12\n    const radius = Math.max(\n      Math.hypot(clickX, clickY),\n      Math.hypot(rect.width - clickX, clickY),\n      Math.hypot(clickX, rect.height - clickY),\n      Math.hypot(rect.width - clickX, rect.height - clickY),\n    );\n    const size = radius * 2;\n\n    // ripple \uC694\uC18C \uC0DD\uC131\n    const rippleEl = document.createElement(\"span\");\n    rippleEl.classList.add(rippleStyle);\n    rippleEl.style.width = rippleEl.style.height = `${size}px`;\n    rippleEl.style.left = `${clickX - radius}px`;\n    rippleEl.style.top = `${clickY - radius}px`;\n    el.appendChild(rippleEl);\n\n    // \uC0C1\uD0DC \uAD00\uB9AC\n    let scaleAnimationEnded = false;\n    let pointerReleased = false;\n\n    const tryFadeOut = () => {\n      if (scaleAnimationEnded && pointerReleased) {\n        rippleEl.classList.add(rippleOut);\n      }\n    };\n\n    // AbortController\uB85C \uC774\uBCA4\uD2B8 \uB9AC\uC2A4\uB108 \uC77C\uAD04 \uAD00\uB9AC\n    const ac = new AbortController();\n    activeControllers.add(ac);\n\n    const cleanup = () => {\n      ac.abort();\n      activeControllers.delete(ac);\n      rippleEl.remove();\n    };\n    const { signal } = ac;\n\n    // \uC560\uB2C8\uBA54\uC774\uC158 \uC644\uB8CC \uCC98\uB9AC\n    rippleEl.addEventListener(\n      \"animationend\",\n      () => {\n        if (rippleEl.classList.contains(rippleOut)) {\n          // fadeout \uC560\uB2C8\uBA54\uC774\uC158 \uC644\uB8CC \u2192 \uC81C\uAC70\n          cleanup();\n        } else {\n          // scale \uC560\uB2C8\uBA54\uC774\uC158 \uC644\uB8CC \u2192 fadeout \uC2DC\uB3C4\n          scaleAnimationEnded = true;\n          tryFadeOut();\n        }\n      },\n      { signal },\n    );\n\n    // pointerup/pointercancel \uCC98\uB9AC\n    const onPointerRelease = () => {\n      pointerReleased = true;\n      tryFadeOut();\n    };\n\n    document.addEventListener(\"pointerup\", onPointerRelease, { signal });\n    document.addEventListener(\"pointercancel\", onPointerRelease, { signal });\n  });\n};\n"],
  "mappings": "AAAA,SAAS,2BAA2B;AACpC,SAAS,iBAAiB;AAC1B,SAAS,WAAW,mBAAmB;AAKvC,SAAS,gBAAgB,IAAsB;AAC7C,SAAO,CAAC,YAAY,YAAY,SAAS,QAAQ,EAAE,SAAS,iBAAiB,EAAE,EAAE,QAAQ;AAC3F;AA8CO,MAAM,SAAS,CAAC,IAAiB,UAA0C;AAEhF,QAAM,oBAAoB,oBAAI,IAAqB;AAGnD,YAAU,MAAM;AACd,eAAW,MAAM,mBAAmB;AAClC,SAAG,MAAM;AAAA,IACX;AACA,sBAAkB,MAAM;AAExB,OAAG,iBAAiB,IAAI,WAAW,EAAE,EAAE,QAAQ,CAAC,aAAa,SAAS,OAAO,CAAC;AAAA,EAChF,CAAC;AAED,sBAAoB,IAAI,eAAe,CAAC,MAAoB;AAC1D,UAAM,UAAU;AAGhB,UAAM,UAAU,YAAY,UAAa,YAAY,QAAS,OAAO,YAAY,YAAY,QAAQ,YAAY;AACjH,UAAM,wBAAwB,OAAO,YAAY,YAAY,QAAQ,oBAAoB;AAEzF,QAAI,CAAC,QAAS;AAGd,QAAI,uBAAuB;AACzB,QAAE,gBAAgB;AAAA,IACpB;AAEA,QAAI,CAAC,gBAAgB,EAAE,GAAG;AACxB,SAAG,MAAM,WAAW;AAAA,IACtB;AACA,OAAG,MAAM,WAAW;AAGpB,UAAM,OAAO,GAAG,sBAAsB;AACtC,UAAM,SAAS,EAAE,UAAU,KAAK;AAChC,UAAM,SAAS,EAAE,UAAU,KAAK;AAGhC,UAAM,SAAS,KAAK;AAAA,MAClB,KAAK,MAAM,QAAQ,MAAM;AAAA,MACzB,KAAK,MAAM,KAAK,QAAQ,QAAQ,MAAM;AAAA,MACtC,KAAK,MAAM,QAAQ,KAAK,SAAS,MAAM;AAAA,MACvC,KAAK,MAAM,KAAK,QAAQ,QAAQ,KAAK,SAAS,MAAM;AAAA,IACtD;AACA,UAAM,OAAO,SAAS;AAGtB,UAAM,WAAW,SAAS,cAAc,MAAM;AAC9C,aAAS,UAAU,IAAI,WAAW;AAClC,aAAS,MAAM,QAAQ,SAAS,MAAM,SAAS,GAAG,IAAI;AACtD,aAAS,MAAM,OAAO,GAAG,SAAS,MAAM;AACxC,aAAS,MAAM,MAAM,GAAG,SAAS,MAAM;AACvC,OAAG,YAAY,QAAQ;AAGvB,QAAI,sBAAsB;AAC1B,QAAI,kBAAkB;AAEtB,UAAM,aAAa,MAAM;AACvB,UAAI,uBAAuB,iBAAiB;AAC1C,iBAAS,UAAU,IAAI,SAAS;AAAA,MAClC;AAAA,IACF;AAGA,UAAM,KAAK,IAAI,gBAAgB;AAC/B,sBAAkB,IAAI,EAAE;AAExB,UAAM,UAAU,MAAM;AACpB,SAAG,MAAM;AACT,wBAAkB,OAAO,EAAE;AAC3B,eAAS,OAAO;AAAA,IAClB;AACA,UAAM,EAAE,OAAO,IAAI;AAGnB,aAAS;AAAA,MACP;AAAA,MACA,MAAM;AACJ,YAAI,SAAS,UAAU,SAAS,SAAS,GAAG;AAE1C,kBAAQ;AAAA,QACV,OAAO;AAEL,gCAAsB;AACtB,qBAAW;AAAA,QACb;AAAA,MACF;AAAA,MACA,EAAE,OAAO;AAAA,IACX;AAGA,UAAM,mBAAmB,MAAM;AAC7B,wBAAkB;AAClB,iBAAW;AAAA,IACb;AAEA,aAAS,iBAAiB,aAAa,kBAAkB,EAAE,OAAO,CAAC;AACnE,aAAS,iBAAiB,iBAAiB,kBAAkB,EAAE,OAAO,CAAC;AAAA,EACzE,CAAC;AACH;",
  "names": []
}
